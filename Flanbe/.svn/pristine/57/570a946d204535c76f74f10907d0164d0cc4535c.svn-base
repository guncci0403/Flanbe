<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
        
<script>
//문서 로딩이 완료되고 나서 실행되는 영역
$(function(){
	$("#goinsert").on("click", function(){
		$("#insertFrm").submit();
	});
	$("#goupdate").on("click", function(){
		$("#updateFrm").submit();
	});
	$("#godelete").on("click", function(){
		$("#deleteFrm").submit();
	});
});
</script>
<style>
    .nav-link:hover {color: var(--primarycolor);}
	.slimScrollDiv {min-height: 600px!important;} 
	.scrollertodo {min-height: 600px!important;}
</style>

<form id="insertFrm" action="${cp }/board/insertRePost" >
	<input type="hidden" name="pa_no" value="${selectPost.p_no }"/>
	<input type="hidden" name="b_no" value="${bno }"/>
	<input type="hidden" name="page" value="${page }"/>
</form>
<form id="updateFrm" action="${cp }/board/updatePost" >
	<input type="hidden" name="p_no" value="${selectPost.p_no }"/>
	<input type="hidden" name="b_no" value="${bno }"/>
	<input type="hidden" name="page" value="${page }"/>
</form>
<form id="deleteFrm" action="${cp }/board/deletePost" >
	<input type="hidden" name="p_no" value="${selectPost.p_no }"/>
	<input type="hidden" name="b_no" value="${bno }"/>
</form>

        <!-- START: Main Content-->
        <main class="flanbe">
            <div class="container-fluid site-width">
                <!-- START: Breadcrumbs-->
                <div class="row ">
                    <div class="col-12  align-self-center">
                        <div class="sub-header mt-3 py-3 align-self-center d-sm-flex w-100 rounded">
                            <div class="w-sm-100 mr-auto"><h4 class="mb-0">프랜비 소식</h4></div>
                        </div>
                    </div>
                </div>
                <!-- END: Breadcrumbs-->

                <!-- START: Card Data-->
                <div class="row row-eq-height">
                    <div class="col-12 col-lg-2 mt-3 todo-menu-bar flip-menu pr-lg-0">
                        <a href="#" class="d-inline-block d-lg-none mt-1 flip-menu-close"><i class="icon-close"></i></a>
                        <div class="card border h-100 todo-menu-section">
                            <div class="card-header d-flex justify-content-between align-items-center">  
                                <h5 class="mb-0">${selectBoard.b_nm }</h5>
                               
                                <!-- Add Todo -->
                                <div class="modal fade" id="newtodo">
                                    <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">
                                                    <i class="icon-pencil"></i> Add Todo
                                                </h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <i class="icon-close"></i>
                                                </button>
                                            </div>
                                            <form class="add-todo-form">
                                                <div class="modal-body">                                               

                                                    <div class="form-group">
                                                        <label for="title" class="col-form-label">Title</label>
                                                        <input type="text" class="form-control" id="title">
                                                    </div>                                                    

                                                    <div class="form-group">
                                                        <label for="description" class="col-form-label">Description</label>
                                                        <textarea class="form-control" rows="10" id="description"></textarea>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="chkbox">                                                        
                                                            <input type="checkbox" class="starred" id="starred">
                                                            <span class="checkmark"></span>
                                                            Starred
                                                        </label>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="chkbox">                                                        
                                                            <input type="checkbox" class="important" id="important">
                                                            <span class="checkmark"></span>
                                                            Important
                                                        </label>
                                                    </div>

                                                </div>
                                                <div class="modal-footer">
                                                    <button type="submit" class="btn btn-primary add-todo">Submit</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <!-- Edit Todo -->
                                <div class="modal fade" id="edittodo">
                                    <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">
                                                    <i class="icon-pencil"></i> Edit Todo
                                                </h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <i class="icon-close"></i>
                                                </button>
                                            </div>
                                            <form class="edit-todo-form">
                                                <div class="modal-body">                                               

                                                    <div class="form-group">
                                                        <label for="title" class="col-form-label">Title</label>
                                                        <input type="text" class="form-control" id="edit-title">
                                                    </div>                                                    

                                                    <div class="form-group">
                                                        <label for="description" class="col-form-label">Description</label>
                                                        <textarea class="form-control" rows="10" id="edit-description"></textarea>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="chkbox">                                                        
                                                            <input type="checkbox" class="starred" id="edit-starred">
                                                            <span class="checkmark"></span>
                                                            Starred
                                                        </label>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="chkbox">                                                        
                                                            <input type="checkbox" class="important" id="edit-important">
                                                            <span class="checkmark"></span>
                                                            Important
                                                        </label>
                                                    </div>

                                                </div>
                                                <div class="modal-footer">
                                                    <input type="hidden"  id="edit-date">
                                                    <button type="submit" class="btn btn-primary add-todo">Update</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- <ul class="nav flex-column todo-menu"> -->
                            <ul style="margin-top: 30px; flex-direction: column!important; display: flex; flex-wrap: wrap; padding-left: 0;
                            margin-bottom: 0; list-style: none;">
                            	<c:forEach items="${boardList }" var="board" varStatus="loop">
	                                <li class="nav-item" style="padding: 5px 15px;">
		                                <c:choose>
											<c:when test="${board.b_no == bno}">
												<a class="nav-link active" href="${cp }/board/view?b_no=${board.b_no }"
												style="color: var(--primarycolor); font-weight: 700; position: relative;
												border-left: 12px solid var(--primarycolor); background-color: var(--sidebarbordercolor);">
			                                    	<input type="hidden" name="b_no" value="${board.b_no }">
			                                        <i class="icon-arrow-right"></i> ${board.b_nm }
			                                    </a>
											</c:when>
											<c:otherwise>
												<a class="nav-link" href="${cp }/board/view?b_no=${board.b_no }" style=" font-weight: 700; position: relative;">
			                                    	<input type="hidden" name="b_no" value="${board.b_no }">
			                                        <i class="icon-arrow-right"></i> ${board.b_nm }
			                                    </a>
											</c:otherwise>
										</c:choose>
	                                </li>
                                </c:forEach>
                            </ul>          

                        </div>  
                    </div>
                    <div class="col-12 col-lg-10 mt-3 pl-lg-0">
                        <div class="card border h-100 todo-list-section">
                            <div class="card-header border-bottom p-2 d-flex" style="height: 55px;">
                                <div class="col-sm-12 col-md-7" style="padding-left: 0;">
									<div class="dataTables_paginate paging_simple_numbers" id="dataTable_paginate">
										<ul class="pagination" style="margin-bottom: 0; ">
											<li class="paginate_button page-item previous" id="dataTable_previous">
												<a href="${cp }/board/view?b_no=${bno }&page=${page}" aria-controls="dataTable" data-dt-idx="0" tabindex="0" class="page-link"><i class="icon-arrow-left"></i></a>
											</li>	
										</ul>
									</div>
								</div>
						 	<c:choose>
								<c:when test="${S_USER.user_id == 'rhksflwk'}">	
										 <a id="goinsert" class="btn btn-primary py-2 px-2 rounded ml-auto text-white">
		                                   <i class="icon-plus align-middle text-white"></i> <span>답글 등록</span>
			                             </a>
                             	</c:when>
                             	<c:when test="${selectBoard.b_nm == '건의사항'}">
										 <a id="goinsert" class="btn btn-primary py-2 px-2 rounded ml-auto text-white">
		                                   <i class="icon-plus align-middle text-white"></i> <span>답글 등록</span>
			                             </a>
                             	</c:when>
                            </c:choose>
                            </div>
                            <div class="card-body p-0">

                                <div class="scrollertodo">
                                    <ul class="todo-list">
									<div class="col-md-12 col-lg-12">
                                        <div class="card-body border brd-gray border-top-0 border-right-0 border-left-0">
                                            <h3 class="mb-0"><a class="f-weight-500 text-primary">${selectPost.p_title }</a></h3>
                                        </div>
                                        <div class="card-body border border-top-0 border-right-0 border-left-0">
                                            <div class="clearfix">
                                                <div class="float-left mr-2">
                                                	작성 일 : <fmt:formatDate value="${selectPost.p_regdt }" pattern="yyyy.MM.dd"/>
                                                </div>
                                                <span>&nbsp;&nbsp;&nbsp;작성자 : ${selectPost.user_id }</span>
                                                <span>&nbsp;&nbsp;&nbsp;&nbsp;조회수 : ${selectPost.p_view }</span>
                                            </div>
                                        </div>
                                        <div class="card-body border brd-gray border-top-0 border-right-0 border-left-0">
                                            <p class="mb-0" lang="ca">${selectPost.p_cont }</p>
                                        </div>
										<c:if test="${attachList != null}">
                                        <div class="card-body border brd-gray border-top-0 border-right-0 border-left-0">
                                            <span>첨부파일</span>
											<ol>
												<c:forEach items="${attachList }" var="attach">
													<li class="nav-item" style="padding: 5px 15px; cursor: pointer;"  onclick="location.href='/board/fileDownload?a_no=${attach.a_no}'">${attach.a_nm }</li>					
												</c:forEach>								                            	
											</ol>
                                        </div>
										</c:if>	
                                         <c:if test="${S_USER.user_id == selectPost.user_id}">
                                           <div class="card-body border brd-gray border-top-0 border-right-0 border-left-0 border-bottom-0">
   
                                               <div class="d-inline-block mr-12" style="margin-left: 85%;">
                                                   <a id="goupdate" class="btn btn-primary py-2 px-2 rounded ml-auto text-white"><span> 수 정 </span></a>
                                                   <a id="godelete" class="btn btn-primary py-2 px-2 rounded ml-auto text-white"><span> 삭 제 </span></a>
                                               </div>
                                           </div>
                                        </c:if>
                                        <c:if test="${S_USER.user_id == 'rhksflwk'}">
                                           <div class="card-body border brd-gray border-top-0 border-right-0 border-left-0 border-bottom-0">
   
                                               <div class="d-inline-block mr-12" style="margin-left: 85%;">
                                                   <a id="goupdate" class="btn btn-primary py-2 px-2 rounded ml-auto text-white"><span> 수 정 </span></a>
                                                   <a id="godelete" class="btn btn-primary py-2 px-2 rounded ml-auto text-white"><span> 삭 제 </span></a>
                                               </div>
                                           </div>
                                        </c:if>
                                    </div> 
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END: Card DATA-->
            </div>
        </main>